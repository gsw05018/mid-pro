<!DOCTYPE html>
<html layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/festival_detail.css">

    <!-- 제이쿼리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
<div layout:fragment="content" class="container my-3">
    <div class="wrap-box">
        <!-- 축제 세부 정보 및 이미지 시작-->

        <!-- 1. 선택한 축제 제목(title) 띄우기 -->
        <h1 th:text="${selectedFestival.title}"></h1>

        <div class="img">
            <!-- 2. 선택한 축제 이미지 띄우기 -->
            <img th:src="${selectedFestival.picture}" alt="이미지 대체" style="width: 70%">
        </div>
        <div class="info-container">
            <!-- 여기에 추가 정보나 텍스트를 넣을 수 있음 -->
            <table border="1">
                <th></th>
                <th></th>
                <tr>
                    <!-- 3. 선택한 축제 정보(title, address, event_Period) 불러오기 -->
                    <td>이름</td>
                    <td th:text="${selectedFestival.title}"></td>
                </tr>
                <tr>
                    <td>주소</td>
                    <td th:text="${selectedFestival.address}"></td>
                    <div id="selectedFestivalAdress" th:text="${selectedFestival.address}" style="display:none;"></div>
                </tr>
                <tr>
                    <td>행사일자</td>
                    <td th:text="${selectedFestival.event_Period}"</td>
                </tr>
                <th></th>
                <th></th>
            </table>

            <div class="button-container">
                <a th:href="${site_link}" target="_blank" class="square-button">축제 사이트로 이동</a>
                <a href="#" class="shortcut-button">
                    <i class="fas fa-link"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- 지도 api 넣기 시작 -->
    <!--구글 지도-->
    <h1>오시는 길</h1>
    <div class="map">
        <p style="margin-top:-12px">
            <em class="link">
                <a href="javascript:void(0);"
                   onclick="window.open('http://fiy.daum.net/fiy/map/CsGeneral.daum', '_blank', 'width=981, height=650')">
                    혹시 주소 결과가 잘못 나오는 경우에는 여기에 제보해주세요.
                </a>
            </em>
        </p>
        <div id="map" style="width: 500px; height: 400px; margin: 100px auto 0"></div>

        <script type="text/javascript"
                src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f2e8b8dfe2eeda94b06ca3878c8af6cf&libraries=services"></script>
        <script>
           var selectedFestivalAdress = $("#selectedFestivalAdress").text();
           var mapContainer = document.getElementById('map'), // 지도를 표시할 div
               mapOption = {
                   center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
                   level: 3 // 지도의 확대 레벨
               };

           // 지도를 생성합니다
           var map = new kakao.maps.Map(mapContainer, mapOption);

           // 주소-좌표 변환 객체를 생성합니다
           var geocoder = new kakao.maps.services.Geocoder();

           // 주소로 좌표를 검색합니다
           geocoder.addressSearch(selectedFestivalAdress, function(result, status) {
               // 정상적으로 검색이 완료됐으면
                if (status === kakao.maps.services.Status.OK) {
                   var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                   // 결과값으로 받은 위치를 마커로 표시합니다
                   var marker = new kakao.maps.Marker({
                       map: map,
                       position: coords
                   });

                   // 인포윈도우로 장소에 대한 설명을 표시합니다
                   var infowindow = new kakao.maps.InfoWindow({
                       content: '<div style="width:150px;text-align:center;padding:6px 0;">요기</div>'
                   });
                   infowindow.open(map, marker);

                   // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
                   map.setCenter(coords);
               }
           });
        </script>
    </div>
    <!-- 지도 api 넣기 끝 -->

    <!-- 댓글 구현 시작 -->
    <div class="comment">
        <h1>댓글 작성하기</h1>
        <!-- 5. 댓글 작성 기능 추가 -->
        <div>
            <input type="text" placeholder="댓글 작성은 큰 힘이 됩니다." id="commentInput">
            <button id="commentSubmit">댓글 작성</button>
        </div>

        <ul class="commentList">
            <li class="commentListList">
                <span class="commentAuthor">kcm0987</span>
                <p>재밌었고 가는길에 차가 좀 막혔어요</p>
            </li>
            <!-- 댓글 목록은 여기에 추가될 것입니다. -->
        </ul>
    </div>
    <!-- 댓글 구현 끝 -->
</div>

<!-- JavaScript 코드를 추가하여 댓글 작성 기능을 구현할 수 있습니다. -->
<script>
    $(document).ready(function () {
        $("#commentSubmit").click(function () {
            var commentText = $("#commentInput").val();
            // 여기에서 서버에 댓글을 전송하고 목록에 추가하는 로직을 추가해야 합니다.
            // AJAX나 기타 웹 요청 기술을 사용하여 서버와 통신할 수 있습니다.
        });
    });
</script>

</body>
</html>
