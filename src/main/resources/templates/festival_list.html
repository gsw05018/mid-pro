<!DOCTYPE html>
<html layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/festival_list.css">

    <!--  제이쿼리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- 새로운 스크립트를 추가하여 필터링 기능을 구현합니다. -->
    <script>
        // 문서 로딩 완료 시 실행될 JavaScript 코드
        $(document).ready(function () {
            // 사용자가 체크박스 또는 라디오 버튼을 변경할 때마다 필터링을 수행합니다.
            $('input[type="checkbox"], input[type="radio"]').on('change', function () {
                filterFestivals(); // 필터링 함수 호출
            });

            // 필터링 함수 정의
            function filterFestivals() {
                // 선택된 지역과 분야를 수집합니다.
                var selectedRegions = [];
                var selectedCategory = $('input[name="radio"]:checked').val();

                $('.checkbox1:checked').each(function () {
                    selectedRegions.push($(this).text().trim());
                });

                // 모든 축제 아이템을 숨깁니다.
                $('.festival-item').hide();

                // 선택된 지역 또는 분야에 맞게 축제 아이템을 표시합니다.
                $('.festival-item').each(function () {
                    var festivalRegion = $(this).attr('data-region');
                    var festivalCategory = $(this).attr('data-category');

                    if (
                        (selectedRegions.length === 0 || selectedRegions.includes(festivalRegion)) &&
                        (selectedCategory === "all" || selectedCategory === festivalCategory)
                    ) {
                        $(this).show();
                    }
                });
            }
        });
    </script>
</head>

<body>
<div layout:fragment="content" class="container my-3">
    <div class="wrap-box">
        <!-- 축제정보 페이지 구현 시작-->
        <div class="outtrack">
            <!-- 지역별 검색 -->
            <div class="selectlist">
                <h2><span>지역별 검색</span></h2>
                <div class="image-container">
                    <img src="https://mblogthumb-phinf.pstatic.net/MjAyMDAzMjNfMjIx/MDAxNTg0OTU1NDQwODQw.pgdMrlFpHuyYm8WVtqxcz9kMlOrnqnUAh9HJUzTES2cg.iWkik9RmfMMmX8Zl1s0eGHmg_qBrsqc_0VF4JdALiRMg.JPEG.hakarashi/%EB%8C%80%ED%95%9C%EB%AF%BC%EA%B5%AD(%ED%95%9C%EA%B5%AD)%EC%A7%80%EB%8F%84.jpg?type=w800" alt="Your Image">
                    <div class="searchall">
                        <input type="checkbox" id="cc" onclick="javascript:checkAll(this)" />
                        <label for="cc">전체 적용</label>
                    </div>
                    <div class="seoul">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        서울
                    </div>
                    <div class="incheon">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        인천
                    </div>
                    <div class="gyeonggi">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        경기
                    </div>
                    <div class="gangwon">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        강원
                    </div>
                    <div class="chungbuk">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        충북
                    </div>
                    <div class="chungnam">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        충남
                    </div>
                    <div class="daejeon">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        대전
                    </div>
                    <div class="sejong">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        세종
                    </div>
                    <div class="kyeongbuk">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        경북
                    </div>
                    <div class="kyeongnam">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        경남
                    </div>
                    <div class="daegu">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        대구
                    </div>
                    <div class="ulsan">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        울산
                    </div>
                    <div class="busan">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        부산
                    </div>
                    <div class="gwangju">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        광주
                    </div>
                    <div class="jeonbuk">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        전북
                    </div>
                    <div class="jeonnam">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        전남
                    </div>
                    <div class="jeju">
                        <input type="checkbox" id="checkbox" class="checkbox1">
                        제주
                    </div>
                </div>
            </div>

            <!--분야별 검색-->
            <div class="searchtype">
                <h2><span>분야별 검색</span></h2>
                <div class="radiolocal">
                    <div>
                        <input type="radio" name="category" value="all" checked ondblclick="this.checked=false"> 전체 <!-- 추가 -->
                    </div>
                    <div>
                        <input type="radio" name="category" value="radiolocal" ondblclick="this.checked=false"> 농촌문화
                    </div>
                    <div>
                        <input type="radio" name="category" value="extensivefestival" ondblclick="this.checked=false"> 대규모 행사
                    </div>
                    <div class="culturetour">
                        <input type="radio" name="category" value="culturetour" ondblclick="this.checked=false"> 문화관광
                    </div>
                    <div>
                        <input type="radio" name="category" value="cultureart" ondblclick="this.checked=false"> 문화예술
                    </div>
                    <div>
                        <input type="radio" name="category" value="ecology" ondblclick="this.checked=false"> 생태자연
                    </div>
                    <div>
                        <input type="radio" name="category" value="anniversaryfestival" ondblclick="this.checked=false"> 기념행사
                    </div>
                    <div>
                        <input type="radio" name="category" value="tradition" ondblclick="this.checked=false"> 전통행사(역사, 문화 등)
                    </div>
                    <div>
                        <input type="radio" name="category" value="fashionbeauty" ondblclick="this.checked=false"> 패션 뷰티
                    </div>
                    <div>
                        <input type="radio" name="category" value="communication" ondblclick="this.checked=false"> 주민화합
                    </div>
                    <div>
                        <input type="radio" name="category" value="astronomyscience" ondblclick="this.checked=false"> 천문과학
                    </div>
                </div>
            </div>
        </div>
    </div>

    <h1 style="margin-left: 10% !important;">진행 중인 축제 리스트</h1>
    <div class="festival-list">
        <div class="festival-item" th:each="festival : ${festivals}">
            <a th:href="@{|/festival/detail/${festival.id}|}">
                <img th:src="${festival.picture}" alt="축제 이미지">
                <h2 th:text="${festival.title}">축제 제목</h2>
                <p th:text="${festival.event_Period}">축제 기간</p>
            </a>
        </div>
        <!-- 나머지 축제 아이템들도 유사한 방식으로 추가합니다. -->
    </div>

    <div class="festival-pagination">
        <!-- 이전 페이지로 이동하는 링크 -->
        <a th:if="${currentPage > 1}" th:href="@{|/festival/list/page/${currentPage - 1}|}">&lt;</a>

        <!-- 페이지 버튼 표시 -->
        <span th:each="pageNum : ${#numbers.sequence(1, totalPages)}">
        <a th:if="${pageNum == currentPage}" th:text="${pageNum}" class="page-number current-page"></a>
        <a th:if="${pageNum != currentPage}" th:href="@{|/festival/list/page/${pageNum}|}" th:text="${pageNum}" class="page-number"></a>
    </span>

        <!-- 다음 페이지로 이동하는 링크 -->
        <a th:if="${currentPage < totalPages}" th:href="@{|/festival/list/page/${currentPage + 1}|}">&gt;</a>
    </div>
</div>
</body>
</html>
